---
import { t, changeLanguage } from "i18next";
//components
import Layout from "@layouts/Layout.astro";
import SealSeriesForPoolAndSpaPumpLayout from "@layouts/pages/product/SealSeriesForPoolAndSpaPumpLayout.astro";
import SealSeriesForVerticalMultiStagePumpLayout from "@layouts/pages/product/SealSeriesForVerticalMultiStagePumpLayout.astro";
import SealingSeriesForFlyptPumpLayout from "@layouts/pages/product/SealingSeriesForFlyptPumpLayout.astro";
import StaticRingSeriesLayout from "@layouts/pages/product/StaticRingSeriesLayout.astro";
import InnerSubNav from "@components/theme/InnerSubNav.astro";
import Banner from "@components/theme/Banner.astro";
import BreadCrumbs from "@components/theme/BreadCrumbs.astro";
import BackBtn from "@components/theme/BackBtn.astro";
import ProductsJson from "@data/pages/products.json";
//data types
import type { PageMetaTag, OpenGraphMetaTag, TwitterMetaTag, } from "@customTypes/seo/types";

changeLanguage("cn");

export async function getStaticPaths() {
    return ProductsJson.list.map((product) => {
        return {
            params: {
                category: product.category,
                product: product.slug,
            },
            props: {
                //since the data of the produc is based on the translation file we just need to reference it using the slug instead
                product: {
                    name: t(`products:contents.${product.slug}.name`),
                    slug: product.slug,
                    category: product.category,
                    ogImage: product.ogImage,
                },
            },
        };
    });
}
type Props = {
    product: {
        name: string;
        slug: string;
        category: string;
        ogImage: string;
    };
};
const { product } = Astro.props as Props;
var pageJson = `products:contents.${product.slug}`;
const page: PageMetaTag = {
    title: `${t(pageJson + ".name")} - ${t(`links:${product.category}`)} | ${t("site-info:pageTitle")}`,
    description: t(pageJson + ".pageDescription"),
    author: t(pageJson + ".pageAuthor"),
    keywords: t(pageJson + ".pageKeywords"),
};
const openGraph: OpenGraphMetaTag = {
    title: `${t(pageJson + ".name")} - ${t(`links:${product.category}`)} | ${t("site-info:pageTitle")}`,
    type: "website",
    image: product.ogImage,
    description: t(pageJson + ".openGraphDescription"),
};
const twitter: TwitterMetaTag = {
    cardType: "summary_large_image",
    title: `${t(pageJson + ".name")} - ${t(`links:${product.category}`)} | ${t("site-info:pageTitle")}`,
    description: t(pageJson + ".twitterDescription"),
    image: product.ogImage,
};
const bannerImageSrc = t(pageJson + ".bannerImageSrc");
const bannerHeight = "200px";
const trueImage = false;
const trueImageStyle = "";
let currNewsCategory: string = product.name; //current name of the product item
---

<Layout page={page} openGraph={openGraph} twitter={twitter}>
  <Banner
    bannerImageSrc={bannerImageSrc}
    bannerHeight={bannerHeight}
    trueImage={trueImage}
    trueImageStyle={trueImageStyle}
  />
  <div class="container mx-auto w-full md:w-11/12 lg:w-10/12">
    <InnerSubNav name="products" />
    <div class="mb-6">
      <BreadCrumbs label={currNewsCategory} />
    </div>
    <main class="px-2">
      {
        product.category === "seal-series-for-pool-and-spa-pump" && (
          <SealSeriesForPoolAndSpaPumpLayout product={product} />
        )
      }
      {
        product.category === "seal-series-for-vertical-multi-stage-pump" && (
          <SealSeriesForVerticalMultiStagePumpLayout product={product} />
        )
      }
      {
        product.category === "seal-series-for-flypt-pump" && (
          <SealingSeriesForFlyptPumpLayout product={product} />
        )
      }
      {
        product.category === "static-ring-series" && (
          <StaticRingSeriesLayout product={product} />
        )
      }
    </main>
    <div class="mb-16 flex justify-center">
      <BackBtn />
    </div>
  </div>
</Layout>
