---
/**
 * @param {string} pageName
 */
import { Img } from "astro-imagetools/components";
import i18next, { t, changeLanguage } from "i18next";
import Layout from "@layouts/Layout.astro";
import type {
  PageMetaTag,
  OpenGraphMetaTag,
  TwitterMetaTag,
} from "@customTypes/seo/types";

type Props = {
  pageName: string;
};

const { pageName } = Astro.props as Props;
import navigationJson from "@data/navigation.json";

var refs = navigationJson.links.filter((link) => link.name === pageName)[0];
var metaTagRef = `navigation:navbar.${pageName}.metaTag`;
const pageMetaTag: PageMetaTag = {
    title: t(metaTagRef + ".pageTitle") ?? t("site-info.pageTitle"),
    description: t(metaTagRef + ".pageDescription") ?? t("site-info.pageTitle"),
    keywords: t(metaTagRef + ".pageKeywords") ?? t("site-info:pageKeywords"),
    author: t(metaTagRef + ".pageAuthor") ?? t("site-info:pageAuthor"),
  },
  opengraphMetaTag: OpenGraphMetaTag = {
    title:
      t(metaTagRef + ".ogTitle") ??
      t(metaTagRef + ".pageTitle") ??
      t(metaTagRef + ".twitterTitle") ??
      t("site-info:ogTitle"),
    type: t(metaTagRef + ".ogType") ?? t("site-info:ogType"),
    image:
      t(metaTagRef + ".ogImage") ??
      t(metaTagRef + ".twitterImage") ??
      t("site-info:ogImage"),
    description:
      t(metaTagRef + ".ogDescription") ??
      t(metaTagRef + ".twitterDescription") ??
      t(metaTagRef + ".pageDescription") ??
      t("site-info:ogDescription"),
  },
  twitterMetaTag: TwitterMetaTag = {
    cardType:
      t(metaTagRef + ".twitterCardType") ?? t("site-info:twitterCardType"),
    title:
      t(metaTagRef + ".twitterTitle") ??
      t(metaTagRef + ".ogTitle") ??
      t("site-info:twitterTitle"),
    description:
      t(metaTagRef + ".description") ??
      t(metaTagRef + ".ogDescription") ??
      t("site-info:pageDescription"),
    image:
      t(metaTagRef + ".twitterImage") ??
      t(metaTagRef + ".ogImage") ??
      t("site-info:twitterImage"),
  };
---

<Layout
  page={pageMetaTag}
  openGraph={opengraphMetaTag}
  twitter={twitterMetaTag}
>
  <main>
    <section class="container mx-auto my-4 flex flex-wrap">
      {
        refs.children.map((ref: string) => {
          return (
            <>
              <div class="w-full md:w-6/12 p-4 flex">
                <a
                  href={`/${pageName}/${t(
                    `navigation:navbar.${pageName}.sublinks.` + ref + ".slug"
                  )}/`}
                  class="group drop-shadow-sm transition duration-100 flex 
                  hover:drop-shadow-md "
                >
                  <figure class="flex flex-row border-[1px] border-solid border-[#e5e7eb] flex-grow">
                    <div class="w-[150px] max-h-[150px] shrink-0 flex justify-center items-center">
                      <Img
                        src={t(
                          `navigation:navbar.${pageName}.sublinks.` +
                            ref +
                            ".imageRef"
                        )}
                        alt={t(
                          `navigation:navbar.${pageName}.sublinks.` +
                            ref +
                            ".alt"
                        )}
                        h={100}
                      />
                    </div>
                    <figcaption class="px-4 py-2 w-full bg-[#f1f1f1] space-y-2">
                      <h3 class="group-hover:text-[#0ba0e1]">
                        {t(
                          `navigation:navbar.${pageName}.sublinks.` +
                            ref +
                            ".name"
                        )}
                      </h3>
                      <h4 class="text-[0.75rem] text-[#777]">
                        {t(
                          `navigation:navbar.${pageName}.sublinks.` +
                            ref +
                            ".subText"
                        )}
                      </h4>
                    </figcaption>
                  </figure>
                </a>
              </div>
            </>
          );
        })
      }
    </section>
  </main>
</Layout>
